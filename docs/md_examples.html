<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PAPRECA hybrid off-lattice kMC/MD simulator: Example Applications</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PAPRECA hybrid off-lattice kMC/MD simulator
   &#160;<span id="projectnumber">2.0.0 (17 September 2024)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_examples.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example Applications </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="examples"></a> </p><blockquote class="doxtable">
<p><b>Important note 1:</b> To be able to run all the examples below, please ensure that you have built your LAMMPS library with the following packages: EXTRA-DUMP, MOLECULE, RIGID, and QEQ. See <a class="el" href="md_installation.html#installation">installation</a> and the relevant <a href="https://docs.lammps.org/Build_package.html">LAMMPS documentation page</a> for more information. </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Important note 2:</b> The Adsorption/Desorption and Phosphates examples produce trajectory files (i.e., xyz) with varying (from timestep to timestep) numbers of atoms. <a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a> cannot handle such trajectory files and will only draw the initial state (i.e., the substrate). Consider using another visualization software (e.g., <a href="https://www.ovito.org/">OVITO</a>) capable of handling varying atoms. </p>
</blockquote>
<h1><a class="anchor" id="brownian"></a>
Your first PAPRECA simulation: Brownian Diffusion (random walk)</h1>
<p>The Brownian motion example can be found in the ./Examples/Brownian Self Diffusion/ folder.</p>
<p>Even though PAPRECA is an extension for LAMMPS, it can be deployed to perform pure off-lattice kMC studies. In this example, we will demonstrate how PAPRECA can be used to calculate the temporal evolution of the spatial distribution of Brownian particles confined in a box [1], [2].</p>
<h2><a class="anchor" id="brownian_INPUT"></a>
LAMMPS and PAPRECA input files</h2>
<p>As far as the LAMMPS input file (i.e., in_kmc.lmp) is concerned, note that:</p>
<ul>
<li>The create_atoms command is deployed to create a cluster of atoms of type 1 in the middle of the simulation box.</li>
<li>This simulation is a pure kMC simulation. The choice of pair_style does not make any difference at all.</li>
<li>The pair_coeff 1 1 for the "lj/cut" potential is defined to set the sigma value (i.e., 2.84642 Angstroms). Such value is used to perform collision searches for the diffusion event (see <a class="el" href="md_commands.html#createDiff">create_DiffusionHop command</a>, <a class="el" href="md_commands.html#sigoptions">sigmas_options command</a>, and <a class="el" href="md_commands.html#insigma">init_sigma command</a>).</li>
</ul>
<p>For more information regarding the used LAMMPS commands consider visiting the relevant <a href="https://docs.lammps.org/commands_list.html#">documentation pages</a>.</p>
<p>When it comes to the PAPRECA input file (i.e., in_kmc.ppc), note that:</p>
<ul>
<li>An MD stage is performed every 10 kMC stages. The MD stage produces a trajectory file without affecting the system dynamics.</li>
<li>A diffusion template is set (see <a class="el" href="md_commands.html#createDiff">create_DiffusionHop command</a>) and random_diffvecs with the "3D" option were activated to allow atoms to diffuse anywhere in the 3D space (<a class="el" href="md_commands.html#diffvecs">random_diffvecs command</a>).</li>
</ul>
<h2><a class="anchor" id="brownian_run"></a>
Execution</h2>
<p>The easiest way to run PAPRECA is by running one of the following commands in the directory where the input files are located:</p>
<div class="fragment"><div class="line">mpiexec ../build/papreca -in in_kmc.lmp in_kmc.ppc #modify papreca executable path if necessary</div>
</div><!-- fragment --><p>or</p>
<div class="fragment"><div class="line">mpiexec ../build/papreca -in in_kmc.lmp in_kmc.ppc &gt; log.hybrid #modify papreca executable path if necessary</div>
</div><!-- fragment --><p>or</p>
<div class="fragment"><div class="line">mpirun ../build/papreca -in in_kmc.lmp in_kmc.ppc #modify papreca executable path if necessary</div>
</div><!-- fragment --><p>or</p>
<div class="fragment"><div class="line">mpirun ../build/papreca -in in_kmc.lmp in_kmc.ppc &gt; log.hybrid #modify papreca executable path if necessary</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>Important note 1:</b> Redirecting the screen output to an external file (e.g., log.hybrid) is generally not advised. Such external files can occupy a considerable amount of disc space and potentially lower the performance of PAPRECA. LAMMPS' screen output is already redirected to the log.lammps file and some information from PAPRECA is written on the papreca.log file. </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Important note 2:</b> It is better advised to run the Brownian example as an automated test (see below). </p>
</blockquote>
<p>To run the Brownian motion example as an automated test use "test_brownian.sh" bash script in the example folder directory. Note that, you might have to modify the "papreca_dir" variable in your "test_brownian.sh" script so it points to the path of your PAPRECA executable. If you wish to use "python" instead of "python3" you will also have to modify "test_brownian.sh". In any case, the Brownian test can be executed through one of the following commands:</p>
<div class="fragment"><div class="line">bash test_brownian.sh</div>
</div><!-- fragment --><p>or</p>
<div class="fragment"><div class="line">bash test_brownian.sh &gt; log.brownian</div>
</div><!-- fragment --><p>The automated test runs PAPRECA with the relevant LAMMPS and PAPRECA input files. After the simulation finishes, it calls a python script to plot the spatial distributions of atoms (as exported in the distribution files in the results folder) at various times. The python script also exports an image file in the parent directory named distributions.png.</p>
<h2><a class="anchor" id="brownian_results"></a>
Results</h2>
<div class="image">
<img src="brownian_superslowdown.gif" alt="" width="60%"/>
</div>
<p>The obtained spatial distribution of diffused atoms can be found below:</p>
<div class="image">
<img src="brownian_distribution.png" alt="" width="60%"/>
</div>
<p>Where it can be observed that the distribution can be described by a bell-shaped curve. As expected, the standard deviation (STD) of the distribution becomes greater over time [1], [2], [3].</p>
<h2><a class="anchor" id="brownian_bibliography"></a>
Bibliography</h2>
<p>[1] <a href="https://en.wikipedia.org/wiki/Brownian_motion">wikipedia</a></p>
<p>[2] <a href="https://chem.libretexts.org/Courses/Sacramento_City_College/SCC%3A_Chem_400_-_General_Chemistry_I/Text/02%3A_Atoms_and_ElementsEdit_section/2.1%3A_Brownian_Motion%3A_Evidence_for_Atoms#:~:text=Brownian%20motion%20is%20the%20random,after%20the%20botanist%20Robert%20Brown.">LibreTexts CHEMISTRY</a></p>
<p>[3] Lavenda, B. H. "Nonequilibrium Statistical Thermodynamics.", Dover Publications, 2019</p>
<hr  />
<h1><a class="anchor" id="adsorption"></a>
Monoatomic adsorption and desorption</h1>
<p>The Monoatomic adsorption and desorption example can be found in the ./Examples/Simple Adsorption/ folder.</p>
<p>Once again, this is a pure kMC example (see another pure kMC example here: <a class="el" href="md_examples.html#brownian">Your first PAPRECA simulation: Brownian Diffusion (random walk)</a>). The system comprises an FFC substrate of atoms of type 1. Atoms of type 2 can adsorb, or desorb on the surface with a given probability. The adsorption sites are directly above the parent atoms, at a distance of depo_offset (see <a class="el" href="md_commands.html#createDepo">create_Deposition command</a>). The ultimate goal of this test is to accurately capture the surface coverage as a function of time. The analytic solution for the surface coverage is [1], [2]:</p>
<div class="image">
<img src="ads_analytic.png" alt="" width="30%"/>
</div>
<h2><a class="anchor" id="adsorption_INPUT"></a>
LAMMPS and PAPRECA input files</h2>
<p>For the PAPRECA and LAMMPS input files note that:</p>
<ul>
<li>This is a pure off-lattice kMC example. Hence, a MD (LAMMPS) stage is invoked every 250 kMC stages (as set in the PAPRECA input file) to produce trajectory files and does not affect the dynamics of the system. See the relevant section in the Brownian motion example (i.e., <a class="el" href="md_examples.html#brownian_INPUT">LAMMPS and PAPRECA input files</a>) for additional information.</li>
<li>The pair_coeff command was used (in the LAMMPS input file) to set the sigma values of the pairs of atoms (see <a class="el" href="md_commands.html#createDiff">create_DiffusionHop command</a>, <a class="el" href="md_commands.html#sigoptions">sigmas_options command</a>, and <a class="el" href="md_commands.html#insigma">init_sigma command</a>).</li>
<li>Two predefined events are defined (in the PAPRECA input file) for this simulation: a deposition event (see <a class="el" href="md_commands.html#createDepo">create_Deposition command</a>) and a monoatomic desorption event (see <a class="el" href="md_commands.html#createMonodes">create_MonoatomicDesorption command</a>).</li>
<li>random_depovecs (in the PAPRECA input file) were set to "no" so that adsorption sites can be directly above the parent atoms.</li>
</ul>
<blockquote class="doxtable">
<p><b>Note:</b> See <a class="el" href="md_commands.html#coverage">export_SurfaceCoverage command</a> for additional information regarding the calculation of surface coverage. </p>
</blockquote>
<h2><a class="anchor" id="adsorption_run"></a>
Execution</h2>
<p>This example is meant to be executed as a batch test. To run the batch test, modify the "papreca_dir" directory of your "test_simple_adsdep.sh" file so it points to the path of your PAPRECA executable. If you wish to use "python" instead of "python3" you will also have to modify "test_simple_adsdep.sh". The automated test can be executed through one of the following command:</p>
<div class="fragment"><div class="line">bash test_simple_adsdep.sh</div>
</div><!-- fragment --><p>or</p>
<div class="fragment"><div class="line">bash test_simple_adsdep.sh &gt; log.adsdes</div>
</div><!-- fragment --><p>The batch script will access and modify the template PAPRECA and LAMMPS input files (located in the ./template folder), and perform a series of PAPRECA simulations for different combinations of adsorption/desorption rates. After performing each run, the batch script will call a python script that plots the surface coverage solution as calculated by PAPRECA alongside the analytic solution and exports an image file (in the ./results folder).</p>
<h2><a class="anchor" id="adsorption_results"></a>
Results</h2>
<p>Below you can find a gif of the the system trajectory (after it reaches equilibrium) as well as the relevant surface coverage plot corresponding to an adsorption/desorption rate ratio of 5:</p>
<div class="image">
<img src="langmuir_slowdown.gif" alt="" width="60%"/>
</div>
<div class="image">
<img src="adsorption_5to1.jpg" alt="" width="60%"/>
</div>
<p>Where it can be concluded that the PAPRECA solution matches the analytic solution closely. Of course, a good agreement between the PAPRECA and analytic solutions is observed for all other tested adsorption/desorption rate ratios (see ./results folder).</p>
<h2><a class="anchor" id="adsorption_bibliography"></a>
Bibliography</h2>
<p>[1] Fichthorn, K.A. and Weinberg, W.H. "Theoretical foundations of dynamic Monte Carlo simulations." Journal of Chemical Physics, vol. 95, 1991</p>
<p>[2] <a href="https://courses.physics.illinois.edu/phys466/fa2016/lnotes/KMC.pdf">KMC course from the University of Illinois</a>.</p>
<hr  />
<h1><a class="anchor" id="phosphates"></a>
Film growth from the thermal decomposition of tricresyl phosphate (TCP) molecules on a Fe110 surface.</h1>
<blockquote class="doxtable">
<p><b>DISCLAIMER:</b> This example requires considerably more time to finish than the <a class="el" href="md_examples.html#brownian">Your first PAPRECA simulation: Brownian Diffusion (random walk)</a> and <a class="el" href="md_examples.html#adsorption">Monoatomic adsorption and desorption</a> simulations. See <a href="https://github.com/sntioudis/papreca/tree/main/Examples/Phosphate%20Film%20Growth%20from%20TCP%20on%20Fe110/scalability_data">here</a> for more information regarding the scalability of this example and the required runtime. Also, consider reducing the total number of kMC steps of kMC_steps for shorter runs. </p>
</blockquote>
<p>The files associated with this example can be found in the ./Examples/Phosphate Film Growth from TCP on Fe110/</p>
<p>This example demonstrates the full capabilities of the software. The example is hybrid (i.e., MD/kMC) and involves bond-formation (see <a class="el" href="md_commands.html#createForm">create_BondForm command</a>), bond-breaking (see <a class="el" href="md_commands.html#createBreak">create_BondBreak command</a>), deposition (see <a class="el" href="md_commands.html#createDepo">create_Deposition command</a>), and diffusion (see <a class="el" href="md_commands.html#createDiff">create_DiffusionHop command</a>) events. Following the execution of each predefined event, the LAMMPS library is called (i.e., an MD stage is performed) to relax the interatomic forces and thermalize the system to the target temperature. For a detailed discussion regarding the results from our off-lattice hybrid kMC/MD runs on thin films from TCP molecules consider reading our paper on Computational Materials Science [1]. A hybrid kMC/MD code (written in FORTRAN), specifically designed to study the decomposition of TCP molecules on Fe(110), was used for all simulations in this paper. Nonetheless, the film-growth model can be reproduced in PAPRECA by using the PAPRECA and LAMMPS inputs files, as well as the param.qeq (declaring the coefficients of the <a href="https://docs.lammps.org/fix_qeq.html">QeQ charge equilibration</a> scheme) and TCP.in (initializing an mmm-TCP molecule) files located in the example folder. Note that, the following changes/improvements were made to the old phosphates model [1]:</p>
<ul>
<li>In the newest model, Carbon and Hydrogen species are not deleted from the system following C-O bond breaks.</li>
<li>The reflective walls on the x-y plane above the growing film were removed. Instead, the latest model periodically removes atoms located 20 Angstroms above the film (using the <a class="el" href="md_commands.html#desorb">desorption command</a> in the PAPRECA input file).</li>
</ul>
<h2><a class="anchor" id="phosphates_INPUT"></a>
LAMMPS and PAPRECA input files</h2>
<p>The PAPRECA and LAMMPS input files required to run this example are located in the parent example directory. Comments have been added in both input files to explain the purpose of specific commands.</p>
<h2><a class="anchor" id="phosphates_run"></a>
Execution</h2>
<p>To run this example, you should execute the following command:</p>
<div class="fragment"><div class="line">mpiexec ../build/papreca -in in_kmc.lmp in_kmc.ppc #modify papreca executable path if necessary</div>
</div><!-- fragment --><p>or</p>
<div class="fragment"><div class="line">mpirun ../build/papreca -in in_kmc.lmp in_kmc.ppc #modify papreca executable path if necessary</div>
</div><!-- fragment --><p>or</p>
<div class="fragment"><div class="line">bash test_phosphates.sh #modify papreca executable path if necessary</div>
</div><!-- fragment --><h2><a class="anchor" id="phosphates_results"></a>
Results</h2>
<div class="image">
<img src="phosphates_slowdown.gif" alt="" width="60%"/>
</div>
<p>A complete discussion regarding the results of this study is provided in our previous paper (Ntioudis et al. [1]). Below we showcase the capabilities of the software by providing two example curves that can be produced by PAPRECA:</p>
<div class="image">
<img src="phosphates_results.png" alt="" width="82%"/>
</div>
<p>Where the curve on the left is a height-time plot generated by <a class="el" href="md_commands.html#heightvtime">export_HeightVtime command</a> and the elemental distribution lines on the right can be exported through the <a class="el" href="md_commands.html#Edistributions">export_ElementalDistributions command</a>. Note that, both graphs have been generated using the respective export files at the end of the run (i.e., heightVtime.log after 12000 PAPRECA steps and distributions 12000.log). Furthermore, to reduce noise in the elemental distributions graph running averages of atomic percentages were calculated for every five consecutive height bins.</p>
<h2><a class="anchor" id="phosphates_bibliography"></a>
Bibliography</h2>
<p>[1] Ntioudis, S., et al. "A hybrid off-lattice kinetic Monte Carlo/molecular dynamics method for amorphous thin film growth." Computational Materials Science, vol. 229, 2023</p>
<h1><a class="anchor" id="solvents"></a>
Organic solvents</h1>
<p>The TCP and Toluene subdirectory in the Examples folder contains the input files for 1) a system comprising solely tri-m-cresyl phosphate (mmm-TCP) molecules, and 2) a system of mmm-TCP molecules in a toluene solvent. Both examples are hybrid kMC/MD runs and include a set of (dummy) bond-formation and bond-breaking events. These examples showcase the capabilities of PAPRECA when it comes to capturing solvent/solute interactions. Furthermore, the examples allow for performance comparisons between solvated and unsolvated systems.</p>
<div class="image">
<img src="solvents.png" alt="" width="60%"/>
</div>
<h2><a class="anchor" id="solvents_run"></a>
Execution</h2>
<p>Similarly to the previous sections, the examples can be initiated by calling the PAPRECA executable with either the mpiexec or the mpirun command:</p>
<div class="fragment"><div class="line">mpiexec /path/to/papreca -in in_kmc.lmp in_kmc.ppc</div>
</div><!-- fragment --><p>or</p>
<div class="fragment"><div class="line">mpirun /path/to/papreca -in in_kmc.lmp in_kmc.ppc</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
