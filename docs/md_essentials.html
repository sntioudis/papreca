<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PAPRECA hybrid off-lattice kMC/MD simulator: Essential information (See before you start)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PAPRECA hybrid off-lattice kMC/MD simulator
   &#160;<span id="projectnumber">2.0.0 (17 September 2024)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_essentials.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Essential information (See before you start) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="essentials"></a> </p>
<h1><a class="anchor" id="flowchart"></a>
PAPRECA flowchart</h1>
<p>The main operations of PAPRECA can be summarized in the following flowchart:</p>
<div class="image">
<img src="General_workflow.png" alt="" width="70%"/>
</div>
<p>Note that, in the current version of PAPRECA, event scanning is parallelized. However, event execution is performed serially. More specifically, after discovering all local events, the total rate of each MPI process is communicated to the master MPI processes (i.e., proc 0). Firstly, the master process calculates the total rate of the current step and advances the simulation clock:</p>
<div class="image">
<img src="clock_advance.png" alt="" width="70%"/>
</div>
<p>Where Δt is the kMC time interval, ρ is a pseudo-random uniformly distributed random number between 0 and 1, R is the per-MPI-process/total rate on a given step, and r is a local event rate. After advancing the simulation clock, the master MPI process chooses the event MPI processor by performing a (rejection-free) kMC selection [1], [2], [3]:</p>
<div class="image">
<img src="proc_select.png" alt="" width="70%"/>
</div>
<p>Following, the selected event MPI processor chooses a (local) event for execution (using a rejection-free selection process [1], [2], [3]):</p>
<div class="image">
<img src="event_select.png" alt="" width="70%"/>
</div>
<p>Finally, event data are communicated from the event MPI processor to all other processors and the event is executed globally.</p>
<p>Providing a fully parallelized scheme for event execution within the kMC stage of PAPRECA will be prioritized in future version of the software.</p>
<p>For additional information regarding the rejection-free kMC scheme, as well as the execution/detection of predefined kMC events please see Ntioudis et al. [1], [2] and Fichthorn and Weinberg [3]. For an overview of the LAMMPS software please see Thompson et al. [4].</p>
<h1><a class="anchor" id="supEvents"></a>
Supported Predefined events</h1>
<p>PAPRECA currently supports 5 different classes of predefined events.</p>
<p>1-2) Reactions (bond-formation and bond breaking). See <a class="el" href="md_commands.html#createBreak">create_BondBreak command</a> and <a class="el" href="md_commands.html#createForm">create_BondForm command</a>.</p>
<div class="image">
<img src="events_reaction.png" alt="" width="70%"/>
</div>
<p>3) Molecular and monoatomic deposition. See <a class="el" href="md_commands.html#createDepo">create_Deposition command</a>.</p>
<div class="image">
<img src="events_adsorption.jpg" alt="" width="70%"/>
</div>
<p>4) Monoatomic desorption. See <a class="el" href="md_commands.html#createMonodes">create_MonoatomicDesorption command</a>.</p>
<div class="image">
<img src="events_desorption.png" alt="" width="70%"/>
</div>
<p>5) Diffusion hops. See <a class="el" href="md_commands.html#createDiff">create_DiffusionHop command</a>.</p>
<div class="image">
<img src="events_diffusion.jpg" alt="" width="70%"/>
</div>
<h1><a class="anchor" id="decomposition"></a>
Domain Decomposition</h1>
<p>The domain decomposition of PAPRECA is identical to that of LAMMPS. On each kMC stage, PAPRECA searches for local atomic scale processes by accessing whether an <b>owned</b> atom (by a specific MPI process) can be parent to an elementary step, as defined by a predefined template (e.g., a deposition event declared in the PAPRECA input file). For more information regarding the domain decomposition schemes in LAMMPS see <a href="https://docs.lammps.org/Developer_par_part.html">this documentation page</a>. To learn more about LAMMPS communication schemes see <a href="https://docs.lammps.org/Developer_par_comm.html">this documentation page</a>.</p>
<h1><a class="anchor" id="rnums"></a>
Random Numbers and Repeatability</h1>
<p>As observed in the general flowchart (see <a class="el" href="md_essentials.html#flowchart">PAPRECA flowchart</a>) PAPRECA fires a single event on each kMC stage. This implies that if the number of MPI processes changes (i.e., you run on 4 instead of 16 MPI processes) PAPRECA runs will not be identical (even if the same random_seed is used in <a class="el" href="md_commands.html#random_seed">random_seed command</a>). Nonetheless, even in such cases, PAPRECA is expected to produce statistically equivalent trajectories.</p>
<h1><a class="anchor" id="inputFiles"></a>
PAPRECA and LAMMPS input Files</h1>
<p>A PAPRECA run must be set up with 2 input files:</p>
<ul>
<li>A LAMMPS input file that initializes the simulation units, the simulation box, the periodic boundaries, and creates the initial system configuration (e.g., starting atoms, bonds, etc.). Furthermore, the LAMMPS input file controls any simulation parameter related to the MD stage of the hybrid kMC/MD run (e.g., thermostats, interatomic potential style, interatomic potential coefficients, etc.). A list of the acceptable LAMMPS s can be found <a href="https://docs.lammps.org/s_list.html">here</a>.</li>
<li>A PAPRECA input file that sets up the kMC stage of the hybrid kMC/MD run. More specifically, the PAPRECA input file initializes templates for the predefined events of the kMC stage. In the current version, the following predefined events are supported: Bond-formations (see <a class="el" href="md_commands.html#createForm">create_BondForm command</a>), Bond-breaks (see <a class="el" href="md_commands.html#createBreak">create_BondBreak command</a>), Depositions (see <a class="el" href="md_commands.html#createDepo">create_Deposition command</a>), Monoatomic Adsorptions (see <a class="el" href="md_commands.html#createMonodes">create_MonoatomicDesorption command</a>), and Diffusions (see <a class="el" href="md_commands.html#createDiff">create_DiffusionHop command</a>). For the <a class="el" href="md_commands.html#commands">commands</a> page for the PAPRECA commands documentation.</li>
</ul>
<p>Examples of LAMMPS/PAPRECA input files can be found in the ./Examples folder of the parent PAPRECA <a href="https://github.com/sntioudis/papreca">GitHub repository</a>.</p>
<p>Before you start, it is very important that you familiarize yourself with LAMMPS. See <a href="https://docs.lammps.org/Intro.html">this link</a> from the LAMMPS documentation pages.</p>
<h1><a class="anchor" id="unsupfeaut"></a>
Unsupported Features and illegal commands in LAMMPS input files.</h1>
<ul>
<li>The current version of PAPRECA supports only 3D applications (i.e., no 2D applications are supported).</li>
<li>The following group names are reserved by PAPRECA and <b>cannot</b> be used in the LAMMPS input file: del_atoms, delete_atoms, deletion, new_mol, fluid, frozen.</li>
<li>PAPRECA uses a dummy group with id=1 to perform bond deletions (see this LAMMPS wrapper function for more information <a class="el" href="namespacePAPRECA.html#aba31ac4603f1387a35ed9487a8336f89">PAPRECA::deleteBond()</a>), which means that you should <b>NOT</b> use this bond id to define some another bonded interaction. Please see the "kmc.lmp" file located in ./Examples/Phosphate Film Growth from TCP on Fe110/ for an example demonstrating how you can define multiple bond types.</li>
</ul>
<h1><a class="anchor" id="loglammps"></a>
Dealing with large log.lammps files</h1>
<p>PAPRECA alternates between kMC and MD stages (performed in LAMMPS). At the setup phase of the MD stage, LAMMPS appends various information on the log.lammps file (e.g., LAMMPS version, MPI warnings, LAMMPS inputs). Additionally, LAMMPS outputs minimization and trajectory information during the MD stage. This means that log.lammps files can become very large. A possible way to stop LAMMPS from constantly writing on the log.lammps file is by adding the following line to your LAMMPS input file (see the relevant <a href="https://docs.lammps.org/log.html">LAMMPS documentation page</a>:</p>
<div class="fragment"><div class="line">log none</div>
</div><!-- fragment --><p>Note that the above command will not turn off screen outputs.</p>
<h1><a class="anchor" id="running"></a>
Running a PAPRECA simulation</h1>
<p>After creating your LAMMPS and PAPRECA input files, a PAPRECA run can be performed by running the papreca executable (as built in your build folder) with MPI.</p>
<p>Examples:</p>
<div class="fragment"><div class="line">mpiexec ../build/papreca -in LAMMPSinput.lmp PAPRECAinput.ppc</div>
<div class="line">mpiexec -np 16 ../build/papreca -in LAMMPSinput.lmp PAPRECAinput.ppc</div>
<div class="line">mpirun ../build/papreca -in LAMMPSinput.lmp PAPRECAinput.ppc</div>
<div class="line">mpirun -np 256 ../build/papreca -in LAMMPSinput.lmp PAPRECAinput.ppc</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>Important Note1:</b> Always use the -in flag to properly pass the input files to the papreca executable. </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Important Note2:</b> PAPRECA reads the LAMMPS input file and then the PAPRECA input file. Hence, make sure the LAMMPS input file is provided first in your MPI execution command (e.g., mpiexec or mpirun). </p>
</blockquote>
<h1><a class="anchor" id="fixpapreca"></a>
fix papreca</h1>
<p>Running PAPRECA requires that the following line is added to your LAMMPS input file (after defining the simulation box):</p>
<div class="fragment"><div class="line">fix papreca all papreca</div>
</div><!-- fragment --><p>Of course, using this fix demands that LAMMPS is compiled with the papreca fix (see <a class="el" href="md_installation.html#installation">installation</a>). For more information regarding this fix please refer to <a class="el" href="md_commands.html#FIX_papreca">fix papreca command</a>.</p>
<h1><a class="anchor" id="units"></a>
PAPRECA units</h1>
<p>Units within the MD stage are consistent with units as defined in the LAMMPS input file. Units in LAMMPS are set by the <a href="https://docs.lammps.org/units.html">units command</a>.</p>
<p>Units within the kMC stage are consistent with units as defined in the LAMMPS input file. Nonetheless, event rates (in frequency units) are internally converted to 1/s. This is done to facilitate the passing of intuitive rate values from the PAPRECA input file to the source code (using the rate_arrhenius, rate_hertz, rate_manual options in the create_BondBreak, create_BondForm, create_Deposition, create_DiffusionHop, and create_MonoatomicDesorption <a class="el" href="md_commands.html#commands">commands</a>). For that reason, PAPRECA will always report time in seconds on the terminal and in any exported file (e.g., heightVtime.log or execTimes.log).</p>
<p>The PAPRECA simulation accounts for both the time elapsed within the MD stage (calculated as the product of the trajectory duration and the timestep) as well as the elapsed time within the kMC stage.</p>
<p>Also, be careful when using the <b>rate_arrhenius</b>, <b>rate_hertz</b>, and <b>rate_manual</b> options (see <a class="el" href="md_commands.html#createDepo">create_Deposition command</a>) to set a predefined event template rate. You should always use units as requested by the respective rate calculation option.</p>
<blockquote class="doxtable">
<p><b>Important Note:</b> PAPRECA supports the "lj" LAMMPS unit style. However, if you use "lj" units the reported (BY PAPRECA) time will not account for the elapsed time in the MD stage of the run (i.e., solely the kMC stage time will be considered). This happens because there is no straightforward way of converting time units from "lj" to seconds. </p>
</blockquote>
<h1><a class="anchor" id="essentials_bibliography"></a>
Bibliography</h1>
<p>[1] Ntioudis, S., et al. "PAPRECA: A parallel hybrid off-lattice kinetic Monte Carlo/molecular dynamics simulator", Journal of Open Source Software, 9(98), 6714 (2024). <a href="https://doi.org/10.21105/joss.06714">https://doi.org/10.21105/joss.06714</a></p>
<p>[2] Ntioudis, S., et al. "A hybrid off-lattice kinetic Monte Carlo/molecular dynamics method for amorphous thin film growth", Computational Materials Science, 229, 112421 (2023). <a href="https://doi.org/10.1016/j.commatsci.2023.112421">https://doi.org/10.1016/j.commatsci.2023.112421</a></p>
<p>[3] Fichthorn, K.A. and Weinberg, W.H. "Theoretical foundations of dynamic Monte Carlo simulations." Journal of Chemical Physics, vol. 95, 1991</p>
<p>[4] Thompson, A.P. et al. "LAMMPS - a flexible simulation tool for particle-based materials modeling at the atomic, meso, and continuum scales." Computer Physics Comunications, vol. 272 2022 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
